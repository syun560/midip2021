(this.webpackJsonpmidip2021=this.webpackJsonpmidip2021||[]).push([[0],{182:function(t,e,n){"use strict";n.r(e);var c=n(1),i=n(22),s=n.n(i),a=(n(75),n(3)),r=n(4),o=n(6),l=n(5),d=(n(76),n(70)),j=n(2),u=n(0),h=function(t){Object(o.a)(n,t);var e=Object(l.a)(n);function n(t){var c;return Object(a.a)(this,n),(c=e.call(this,t)).state={message:"please wait...",inPorts:[],outPorts:[],selectedOutPortID:"",selectedInPortID:""},navigator.requestMIDIAccess({sysex:!1}).then((function(t){for(var e=t.inputs.values(),n=[],i=e.next();!i.done;i=e.next()){var s=i.value;n.push({name:s.name,ID:s.id}),s.addEventListener("midimessage",c.inputEvent,!1)}n.length&&c.setState({selectedInPortID:n[0].ID}),c.setState({inPorts:n});var a=[];c.outputs=t.outputs;var r,o=Object(d.a)(c.outputs.values());try{for(o.s();!(r=o.n()).done;){var l=r.value;a.push({device:l,name:l.name,ID:l.id})}}catch(j){o.e(j)}finally{o.f()}a.length&&c.setState({selectedOutPortID:a[0].ID}),c.setState({outPorts:a}),console.log("MIDI READY!!!"),c.setState({message:"MIDI READY"})}),(function(t){console.log("MIDI FAILED - "+t)})),c.doClick=c.doClick.bind(Object(j.a)(c)),c.doChange=c.doChange.bind(Object(j.a)(c)),c.inputEvent=c.inputEvent.bind(Object(j.a)(c)),c}return Object(r.a)(n,[{key:"inputEvent",value:function(t){t.target;var e,n=[];t.data.forEach((function(t){n.push(t.toString(16))})),"f8"!=n[0]&&"fe"!=n[0]&&(e=n.join(" "),this.state.outPorts[0].device.send(t.data),console.log(e))}},{key:"doChange",value:function(t){this.setState({selectedOutPortID:t.target.value})}},{key:"doClick",value:function(){var t=this.outputs.get(this.state.selectedOutPortID);t.send([144,60,100]),t.send([128,60,100],window.performance.now()+500),t.send([144,64,100]),t.send([128,64,100],window.performance.now()+500),t.send([144,67,100]),t.send([128,67,100],window.performance.now()+500)}},{key:"render",value:function(){var t=0,e=this.state.inPorts.map((function(e){return Object(u.jsxs)("option",{value:e.ID,children:[e.name," (",e.ID,")"]},t++)})),n=this.state.outPorts.map((function(e){return Object(u.jsxs)("option",{value:e.ID,children:[e.name," (",e.ID,")"]},t++)}));return Object(u.jsxs)("div",{children:[Object(u.jsx)("p",{children:this.state.message}),Object(u.jsx)("table",{children:Object(u.jsxs)("tbody",{children:[Object(u.jsxs)("tr",{children:[Object(u.jsx)("td",{children:"Input: "}),Object(u.jsx)("td",{children:Object(u.jsx)("select",{children:e})})]}),Object(u.jsxs)("tr",{children:[Object(u.jsx)("td",{children:"Output: "}),Object(u.jsx)("td",{children:Object(u.jsx)("select",{onChange:this.doChange,defaultValue:"-1",children:n})})]})]})}),Object(u.jsx)("button",{className:"btn btn-primary btn-large",onClick:this.doClick,children:"Play C"})]})}}]),n}(c.Component),b=n(24),O=(n(78),{noteEvents:[]});function v(t){t.sort((function(t,e){return(t*=1).tick<(e*=1).tick?-1:t.tick>e.tick?1:t.note<e.note?-1:t.note>e.note?1:0}))}var x=Object(b.b)((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"ADD_EVENT":var n=t.noteEvents.slice();return n.push(e.data),v(n),{noteEvents:n};case"DEL_EVENT":var c=t.noteEvents.filter((function(t){return t.mea!=e.data.mea||t.tick!=e.data.tick||t.note!=e.data.note}));return{noteEvents:c};case"DEL_ALL":return{noteEvents:O.noteEvents};default:return t}})),p=n(7),f=function(t){Object(o.a)(n,t);var e=Object(l.a)(n);function n(t){var c;return Object(a.a)(this,n),(c=e.call(this,t)).tdUnselected={width:"50px"},c.tdSelected={width:"50px",background:"cyan"},c.state={selected:!1},c.doClick=c.doClick.bind(Object(j.a)(c)),c}return Object(r.a)(n,[{key:"doClick",value:function(t){var e=t.target.getAttribute("data-row"),n=t.target.getAttribute("data-col");if(this.setState((function(t){return{selected:!t.selected}})),this.state.selected)this.props.dispatch({type:"DEL_EVENT",data:{mea:1,tick:n,note:e}});else{var c={type:"ADD_EVENT",data:{mea:1,tick:n,note:e,gate:480,vel:100}};this.props.dispatch(c)}}},{key:"render",value:function(){var t=this.props.row,e=this.props.col,n=this.props.noteEvents.find((function(n){return n.note==t&&n.tick==e}));return this.state.selected=void 0!==n,Object(u.jsx)("td",{style:this.state.selected?this.tdSelected:this.tdUnselected,onClick:this.doClick,"data-row":t,"data-col":e})}}]),n}(c.Component),m=Object(p.connect)((function(t){return t}))(f),k=function(t){Object(o.a)(n,t);var e=Object(l.a)(n);function n(t){var c;return Object(a.a)(this,n),(c=e.call(this,t)).th={width:"100px"},c.state={width:16,height:13,baseNote:72},c.doClick=c.doClick.bind(Object(j.a)(c)),c}return Object(r.a)(n,[{key:"doClick",value:function(t){}},{key:"noteNumberToNoteName",value:function(t){}},{key:"render",value:function(){var t=this,e=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],n=this.state.baseNote,c=["C5","B4","A#4","A4","G#4","G4","F#4","F4","E4","D#4","D4","C#4","C4"].map((function(c,i){return Object(u.jsxs)("tr",{children:[Object(u.jsx)("th",{style:t.th,children:c}),e.map((function(t,e){return Object(u.jsx)(m,{row:n-i,col:e},t)}))]},c)}));return Object(u.jsx)("table",{className:"table table-bordered table-sm",children:Object(u.jsx)("tbody",{children:c})})}}]),n}(c.Component),y=function(t){Object(o.a)(n,t);var e=Object(l.a)(n);function n(t){var c;return Object(a.a)(this,n),(c=e.call(this,t)).box={height:"500px",overflow:"auto"},c.state={},c.doClick=c.doClick.bind(Object(j.a)(c)),c}return Object(r.a)(n,[{key:"doClick",value:function(t){}},{key:"render",value:function(){var t=this.props.noteEvents.map((function(t,e){return Object(u.jsxs)("tr",{children:[Object(u.jsx)("td",{children:t.mea}),Object(u.jsx)("td",{children:t.tick}),Object(u.jsx)("td",{children:t.note}),Object(u.jsx)("td",{children:t.gate}),Object(u.jsx)("td",{children:t.vel})]},e)}));return Object(u.jsx)("div",{style:this.box,children:Object(u.jsxs)("table",{className:"table table-sm",children:[Object(u.jsx)("thead",{children:Object(u.jsxs)("tr",{children:[Object(u.jsx)("th",{children:"Mea"}),Object(u.jsx)("th",{children:"Tick"}),Object(u.jsx)("th",{children:"Event"}),Object(u.jsx)("th",{children:"Gate"}),Object(u.jsx)("th",{children:"Vel/Value"})]})}),Object(u.jsx)("tbody",{children:t})]})})}}]),n}(c.Component),g=Object(p.connect)((function(t){return t}))(y),C=function(t){Object(o.a)(n,t);var e=Object(l.a)(n);function n(t){var c;return Object(a.a)(this,n),(c=e.call(this,t)).state={},c}return Object(r.a)(n,[{key:"Play",value:function(){alert("Play\u3046\u3093\u3061")}},{key:"render",value:function(){return Object(u.jsxs)("div",{children:[Object(u.jsx)("p",{children:"\u30d7\u30ec\u30a4\u30e4\u30fc\u306b\u3054\u3056\u308b"}),Object(u.jsx)("p",{children:"\u30b3\u30f3\u30c0\u30af\u30bf\u30fc\u304b\u3089\u306e\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u624b\u306b\u5165\u308c\u308b\u3002"}),Object(u.jsx)("p",{children:"// note\u3092\u691c\u7d22"}),Object(u.jsx)("p",{children:"// \u97f3\u3092\u9cf4\u3089\u3059"})]})}}]),n}(c.Component),P=Object(p.connect)((function(t){return t}))(C),w=function(t){Object(o.a)(n,t);var e=Object(l.a)(n);function n(t){var c;return Object(a.a)(this,n),(c=e.call(this,t)).th={width:"100px"},c.td={width:"50px"},c.tdNow={width:"50px",background:"yellow"},c.maxTick=16,c.state={bpm:120,nowTick:0,isPlaying:!1},c.Play=c.Play.bind(Object(j.a)(c)),c.Proceed=c.Proceed.bind(Object(j.a)(c)),c.ChangeBPM=c.ChangeBPM.bind(Object(j.a)(c)),c}return Object(r.a)(n,[{key:"Play",value:function(){this.state.isPlaying?(this.setState({isPlaying:!1}),clearTimeout(this.timer)):(this.setState({isPlaying:!0}),this.timer=setTimeout(this.Proceed,9600/this.state.bpm))}},{key:"Proceed",value:function(){var t=this;this.setState((function(e){return{nowTick:(e.nowTick+1)%t.maxTick}})),this.timer=setTimeout(this.Proceed,9600/this.state.bpm)}},{key:"ChangeBPM",value:function(t){this.setState({bpm:t.target.value})}},{key:"render",value:function(){for(var t=[],e=0;e<this.maxTick;e++)t.push(Object(u.jsx)("td",{style:this.state.nowTick==e?this.tdNow:this.td},e));return Object(u.jsxs)("div",{children:[Object(u.jsxs)("p",{children:[Object(u.jsx)("input",{type:"number",value:this.state.bpm,min:"0",max:"300",onChange:this.ChangeBPM}),Object(u.jsx)("button",{className:"btn btn-primary",onClick:this.Play,children:this.state.isPlaying?"Playing":"Play"})]}),Object(u.jsx)("table",{className:"table table-bordered table-sm",children:Object(u.jsx)("tbody",{children:Object(u.jsxs)("tr",{children:[Object(u.jsx)("th",{style:this.th,children:"4/4"}),t]})})})]})}}]),n}(c.Component),D=function(t){Object(o.a)(n,t);var e=Object(l.a)(n);function n(t){var c;return Object(a.a)(this,n),(c=e.call(this,t)).state={},c.doClick=c.doClick.bind(Object(j.a)(c)),c}return Object(r.a)(n,[{key:"doClick",value:function(t){this.props.dispatch({type:"DEL_ALL"})}},{key:"render",value:function(){return Object(u.jsxs)("div",{children:[Object(u.jsxs)("div",{className:"row mt-4",children:[Object(u.jsx)("div",{className:"col-md-3",children:Object(u.jsx)(g,{})}),Object(u.jsxs)("div",{className:"col-md-9",children:[Object(u.jsx)(w,{}),Object(u.jsx)(k,{})]}),Object(u.jsx)(P,{})]}),Object(u.jsx)("div",{className:"row",children:Object(u.jsx)("button",{className:"btn btn-danger",onClick:this.doClick,children:"\u3059\u3079\u3066\u524a\u9664"})})]})}}]),n}(c.Component),E=Object(p.connect)((function(t){return t}))(D),I=function(t){Object(o.a)(n,t);var e=Object(l.a)(n);function n(t){return Object(a.a)(this,n),e.call(this,t)}return Object(r.a)(n,[{key:"render",value:function(){return Object(u.jsxs)("div",{className:"container-fluid",children:[Object(u.jsx)(p.Provider,{store:x,children:Object(u.jsx)(E,{})}),Object(u.jsx)("hr",{}),Object(u.jsx)(h,{}),Object(u.jsx)("hr",{}),Object(u.jsx)("h4",{children:"\u30e1\u30e2"}),Object(u.jsx)("li",{children:Object(u.jsx)("a",{href:"https://github.com/syun560/midip2021",children:"GitHub"})}),Object(u.jsx)("li",{children:"Instrument.js\u304c\u5c11\u3057\u8907\u96d1\u306a\u6c17\u304c\u3059\u308b"}),Object(u.jsx)("li",{children:"\u30b3\u30f3\u30bd\u30fc\u30eb\u306bMIDI\u30e1\u30c3\u30bb\u30fc\u30b8\u306f\u51fa\u529b\u3067\u304d\u3066\u3044\u308b\u306e\u3067\u3001\u30a4\u30f3\u30bf\u30e9\u30af\u30c6\u30a3\u30d6\u306a\u51fa\u529b\u3092\u3059\u308b"}),Object(u.jsx)("li",{children:"Output\u304c\u8907\u6570\u3042\u308b\u72b6\u6cc1\u306e\u518d\u73fe\u306f\u3069\u3046\u3057\u305f\u3089\u3044\u3044\uff1f"}),Object(u.jsx)("li",{children:"Program Change\u306e\u30a4\u30d9\u30f3\u30c8\u3082\u9001\u4fe1\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u3088\u3046\u3001\u30bb\u30ec\u30af\u30c8\u30bf\u30b0\u304b\uff1f"}),Object(u.jsx)("li",{children:"\u3042\u308b\u7a0b\u5ea6\u30ad\u30fc\u30dc\u30fc\u30c9\u64cd\u4f5c\u3082\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u3066\u304a\u304f"})]})}}]),n}(c.Component),N=(n(181),function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,184)).then((function(e){var n=e.getCLS,c=e.getFID,i=e.getFCP,s=e.getLCP,a=e.getTTFB;n(t),c(t),i(t),s(t),a(t)}))});s.a.render(Object(u.jsx)(I,{}),document.getElementById("root")),N()},75:function(t,e,n){},76:function(t,e,n){}},[[182,1,2]]]);
//# sourceMappingURL=main.785eeeb1.chunk.js.map